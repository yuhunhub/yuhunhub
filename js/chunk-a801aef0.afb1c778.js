(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a801aef0"],{"0578":function(t,e,s){"use strict";s.r(e);var o=s("8016"),i=s("7395").a,n=s("2877"),r=(i=Object(n.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{attrs:{id:"result-box",title:"一设多套计算流程",visible:t.isShow,width:"80%",fullscreen:t.isFullScreen,"close-on-click-modal":!1},on:{"update:visible":function(e){t.isShow=e}}},[s("div",{staticStyle:{padding:"0 20px"}},[s("el-steps",{attrs:{active:t.activeStep}},[s("el-step",{attrs:{title:"开始计算",description:"通过指定计算条件计算结果"}}),s("el-step",{attrs:{title:"组合对比",description:"从计算结果中筛选出最优多套"}}),s("el-step",{attrs:{title:"完成"}})],1)],1),s("el-divider"),s("div",{staticStyle:{"text-align":"center"}},[s("h6",[s("span",[t._v(t._s(t.currentSet.name))]),t._v(" | "+t._s(t.settingClone&&t.settingClone.summary)+" | 期望"+t._s(t.expectNum)+"套")]),t.searching?s("div",{key:"searching"},[s("i",{staticClass:"el-icon-loading"}),t._v(" 计算中，已找到 "+t._s(t.resultCount)+" 条合格数据，将取其中面板最高 "+t._s(t.setting.limitNum)+" 条…… ("+t._s(t.currentNum)+"/"+t._s(t.totalCount)+") ")]):s("div",{key:"searched"},[s("div",[s("i",{staticClass:"el-icon-success"}),t._v(" 完成，共找到 "+t._s(t.resultCount)+" 条合格数据，用时 "+t._s(t.totalSecond)+" 秒。("+t._s(t.currentNum)+"/"+t._s(t.totalCount)+") ")]),t.isComposeComparing?s("div",[s("i",{staticClass:"el-icon-loading"}),t._v(" 从计算结果中组合对比，筛选出最优10种组合，目前已找到 "+t._s(t.composeResultList.length)+" 种……("+t._s(t.composeCurrentNum)+"/"+t._s(t.composeResultTotal)+") ")]):t._e(),t.isDone?s("div",[s("i",{staticClass:"el-icon-success"}),t._v(" 完成，通过组合对比共找到 "+t._s(t.composeResultList.length)+" 条合格数据，用时 "+t._s(t.composeTotalSecond)+" 秒。("+t._s(t.composeCurrentNum)+"/"+t._s(t.composeResultTotal)+") ")]):t._e()])]),s("el-progress",{attrs:{percentage:t.percent,status:t.searching||t.isComposeComparing||!t.isDone?null:"success"}}),!t.isComposeComparing&&!t.isDone||t.searching?t._e():s("div",[s("result1to-n-table",{attrs:{list:t.composeResultList,"is-show-unim-cols":t.isShowUnimCols,"is-show-prop-score":t.isShowPropScore,"valid-props":t.validProps,"is-show2precision":t.isShow2Precision,"is-mix-hero-data":t.isMixHeroData,setting:t.setting}})],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-checkbox",{model:{value:t.isFullScreen,callback:function(e){t.isFullScreen=e},expression:"isFullScreen"}},[t._v("网页全屏显示")]),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"当前有效属性："+t.validProps.join("，"),placement:"top"}},[s("el-checkbox",{model:{value:t.isShowPropScore,callback:function(e){t.isShowPropScore=e},expression:"isShowPropScore"}},[t._v("显示御魂分数")])],1),s("el-checkbox",{model:{value:t.isMixHeroData,callback:function(e){t.isMixHeroData=e},expression:"isMixHeroData"}},[t._v("代入式神数据")]),s("el-checkbox",{model:{value:t.isShow2Precision,callback:function(e){t.isShow2Precision=e},expression:"isShow2Precision"}},[t._v("显示小数点后2位")]),s("el-checkbox",{staticStyle:{"margin-right":"15px"},model:{value:t.isShowUnimCols,callback:function(e){t.isShowUnimCols=e},expression:"isShowUnimCols"}},[t._v("显示不重要的列(生命/防御等)")]),!t.isDone||t.searching||t.isComposeComparing?t._e():s("el-dropdown",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){return t.clickToRearrange()},command:t.clickToRearrange}},[s("el-button",{attrs:{type:"primary"}},[t._v(" 重新组合"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t._l([2,3,4],(function(e){return[e!==t.expectNum?s("el-dropdown-item",{key:"key"+e,attrs:{command:e}},[t._v("期望"+t._s(e)+"套")]):t._e()]}))],2)],1),t.searching||t.isComposeComparing?s("el-button",{attrs:{type:"danger"},on:{click:t.stop}},[t._v("中止")]):t._e(),s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"可暂时关闭窗口，不影响计算",placement:"top"}},[s("el-button",{on:{click:function(e){t.isShow=!1}}},[t._v("关闭")])],1)],1)],1)}),[],!1,null,"7e79ce56",null).exports,s("4097")),a=s("50cd"),l=s("ea82"),c={components:{PreSettingTree:s("5953").a},props:{value:{type:Object}},data:function(){return{popover:!1,setting:null}},watch:{value:function(){this.setting=this.value},setting:function(){this.$emit("input",this.setting)}},methods:{onSelect:function(t){this.setting=t,this.popover=!1}}},u=(c=Object(n.a)(c,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",[t.setting?e("span",{staticStyle:{"font-size":"17px","font-weight":"bold"}},[t._v(" "+t._s(t.setting.summary)+" ")]):t._e(),e("el-popover",{attrs:{placement:"bottom-start",title:"从已有预设或历史记录中选择",width:"800",trigger:"click"},model:{value:t.popover,callback:function(e){t.popover=e},expression:"popover"}},[e("div",{staticStyle:{"max-height":"500px",overflow:"auto"}},[e("pre-setting-tree",{ref:"presetTree",attrs:{"show-edit":"","show-only-folder":!1,"default-expand-all":!1},on:{onSelect:t.onSelect}})],1),e("el-button",{attrs:{slot:"reference",size:"small"},slot:"reference"},[t._v(" 点此选择 ")])],1)],1)}),[],!1,null,"42b5bb2a",null).exports,s("a01a")),p=s("11f6"),m=s("8f5b"),h=s("bf7f"),d=s("7a4b");i={components:{Result:i,SelectThreadNum:l.a,AdNearCalBtn:u.a,Cal:p.a,SelectPreset:c,SelectExcluded:d.a},mixins:[a.a,m.a,h.a],beforeRouteLeave:function(t,e,s){this.core.searching?s(!1):s()},data:function(){return{isMounted:!1,setting:null,num:2,isShowResultDialog:!1,hasSubmit:!1,rules:Object(r.a)(this),core:this.$refs.core,excluded:{combos:[],yuhuns:[]}}},watch:{setting:{handler:function(){this.setting.summary=Object(o.a)(this.setting,this.setting.heroInfo),this.$forceUpdate()},deep:!0}},mounted:function(){var t=this;this.$nextTick((function(){t.isMounted=!0,t.core=t.$refs.core}))},methods:{onSubmit:function(){this.hasSubmit=!0,this.addHistory(this.setting),this.setting.limitNum=2e3,this.isShowResultDialog=!0;var t=this.excluded.combos,e=this.excluded.yuhuns;this.core.start({excludeList:t,excludeYuhunIds:e})}}},s("bbae"),l=Object(n.a)(i,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{attrs:{id:"yuhun-cal-1toN-index"}},[e("el-row",{staticStyle:{"margin-bottom":"10px"},attrs:{gutter:20}},[e("el-col",{attrs:{span:5,xs:24}},[e("select-excluded",{model:{value:t.excluded,callback:function(e){t.excluded=e},expression:"excluded"}})],1),e("el-col",{attrs:{span:19,xs:24}},[e("h2",[e("i",{staticClass:"el-icon-info"}),t._v(" 一设多套 ")]),e("p",[t._v(" 用于计算"),e("b",[t._v("同一个计算条件")]),t._v("下的"),e("b",[t._v("多套独立最优")]),t._v("阵容，如多鸩、双吞等。 ")]),e("p",[e("b",[t._v("最优")]),t._v("的判断逻辑取决于计算指标面板的多套总和。 ")]),e("el-divider"),e("el-form",{ref:"form",attrs:{"label-width":"90px",size:"mini"}},[e("el-form-item",{attrs:{label:"计算条件"}},[e("select-preset",{ref:"presetTree",model:{value:t.setting,callback:function(e){t.setting=e},expression:"setting"}})],1),e("el-form-item",{attrs:{label:"期望套数"}},[e("el-input-number",{attrs:{min:2,max:4,"step-strictly":!0,precision:0},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}})],1),e("el-form-item",{attrs:{label:""}},[e("el-alert",{staticStyle:{width:"500px"},attrs:{title:"提示",type:"info",closable:!1,"show-icon":""}},[e("div",[e("b",[t._v("计算条件")]),t._v("最好指定足够高的面板下限和最低御魂分数，可加快计算速度。")]),e("div",[e("b",[t._v("期望套数")]),t._v("越多，计算时间越久，对机器内存要求越高。")]),e("div",[e("b",[t._v("注意")]),t._v("一设多套不能在同一个浏览器上开两个页面同时算，会导致结果错乱。")])])],1)],1)],1)],1),t.isMounted?e("div",{staticStyle:{position:"fixed",bottom:"0",left:"0",right:"0",padding:"10px","background-color":"white","z-index":"100","box-shadow":"0 2px 12px 0 rgba(0,0,0,.1)"}},[e("div",{staticStyle:{"text-align":"center"}},[e("ad-near-cal-btn"),e("el-button-group",[e("select-thread-num",{model:{value:t.threadNum,callback:function(e){t.threadNum=e},expression:"threadNum"}}),e("el-button",{attrs:{disabled:t.core.searching||!t.setting||!t.num,type:"primary"},on:{click:t.onSubmit}},[t._v(" 开始计算 "),e("i",{staticClass:"el-icon-s-promotion"})]),t.hasSubmit||t.core.searching||t.core.resultList&&0<t.core.resultList.length?e("el-tooltip",{attrs:{effect:"dark",content:"打开计算结果窗口",placement:"top"}},[e("el-button",{attrs:{type:"success"},on:{click:function(e){t.isShowResultDialog=!0}}},[t._v(" 查看结果 ")])],1):t._e()],1)],1)]):t._e(),e("cal",{ref:"core",attrs:{setting:t.setting,"thread-num":t.threadNum}}),t.isMounted&&t.setting?e("result",{attrs:{setting:t.setting,searching:t.core.searching,"result-count":t.core.resultCount,"total-count":t.core.totalCount,"current-num":t.core.currentNum,"expect-num":t.num},on:{"update:expectNum":function(e){t.num=e},"update:expect-num":function(e){t.num=e},terminate:t.core.terminate},model:{value:t.isShowResultDialog,callback:function(e){t.isShowResultDialog=e},expression:"isShowResultDialog"}}):t._e()],1)}),[],!1,null,null,null);e.default=l.exports},"0a82":function(t,e,s){t.exports=s.p+"js/1.394bbefc.worker.js"},7395:function(t,e,s){"use strict";(function(t){s("a9e3"),s("e9c4"),s("d3b7"),s("7db0"),s("b0c0");var o=s("2f4e"),i=s("e959"),n=s("e73f"),r=s("9d39");e.a={components:{Result1toNTable:n.a},mixins:[r.a],props:{setting:{type:Object},value:{type:Boolean},searching:{type:Boolean},resultCount:{type:Number},totalCount:{type:Number},currentNum:{type:Number},expectNum:{type:Number}},data:function(){return{isShow:!1,isShowCollectionTree:!1,isFullScreen:!1,startTime:null,endTime:null,hasChecked:!1,isShowUnimCols:!1,totalSecond:null,currentData:null,percent:0,newName:null,isShowPropScore:!0,isShow2Precision:!1,isMixHeroData:!0,validProps:[],autoPropsMap:o.a,notify:null,settingClone:null,isSelectFolder:null,isOverrideName:!1,isComposeComparing:!1,isDone:!1,db:null,collectionName:i.a.SearchResults,composeResultList:[],composeResultTotal:0,composeCurrentNum:0,composeCurrentNumCache:0,composeTotalSecond:0,composeMinTotal:0,lastCache:null,currentThreadNum:0,threadNumMax:1,i:1,worker:null}},computed:{activeStep:function(){return this.searching?1:this.isComposeComparing?2:3}},watch:{value:function(){var t;this.isShow=this.value,this.searching&&!1===this.isShow&&(t=this.$createElement,this.notify=this.$notify.info({title:"计算正在进行中……",message:t("p",{style:"color: gray"},"为防止误操作，暂时禁止跳转页面内其他标签页；如需查看其他标签页内容，请在新的浏览器标签或窗口打开本站。"),duration:0})),!0===this.isShow&&this.notify&&this.notify.close()},isShow:function(){this.$emit("input",this.isShow)},currentNum:function(){var t=Math.round(this.currentNum/(this.totalCount||1e-8)*1e3)/10;this.percent=t},composeCurrentNum:function(){var t=Math.round(this.composeCurrentNum/(this.composeResultTotal||1e-8)*1e3)/10;this.percent=t},searching:function(){this.searching?(this.settingClone=JSON.parse(JSON.stringify(this.setting)),this.handleValidProps(),this.percent=0,this.startTime=new Date):this.startTime&&(this.endTime=new Date,this.percent=100,this.totalSecond=Math.round((this.endTime.getTime()-this.startTime.getTime())/100)/10,this.notify&&this.notify.close(),this.startComposeCompare())},isComposeComparing:function(){this.isComposeComparing?(this.percent=0,this.startTime=new Date):this.startTime&&(this.endTime=new Date,this.percent=100,this.composeTotalSecond=Math.round((this.endTime.getTime()-this.startTime.getTime())/100)/10)},currentThreadNum:function(t,e){this.isDone||t<e&&this.nextOne()}},methods:{handleValidProps:function(){var t=this.settingClone.validScore.props;t&&0<t.length?this.validProps=t:this.validProps=this.autoPropsMap[this.settingClone.calTarget]},clickToRearrange:function(t){var e=this;t&&this.$emit("update:expectNum",t),this.stop(),this.$nextTick((function(){setTimeout((function(){e.startComposeCompare()}),200)}))},startComposeCompare:function(){var t=this;0===this.resultCount?this.stop():(this.composeCurrentNum=0,this.composeCurrentNumCache=0,this.isComposeComparing=!0,this.isDone=!1,this.composeMinTotal=0,this.composeResultList=[],this.composeResultTotal=Math.pow(this.resultCount,this.expectNum),this.lastCache=Date.now(),this.$searchResults.find().toArray((function(e,s){t.$error(e),t.startWorker(s)})))},startWorker:function(e){var s=this,o=new Worker(t,void 0);(this.worker=o).postMessage({list:e,resultCount:this.resultCount,expectNum:this.expectNum}),o.onmessage=function(t){t=t.data;var e=t.name;t=t.params;"current"===e?(s.composeCurrentNumCache=t.num,2e3<Date.now()-s.lastCache&&(s.composeCurrentNum=s.composeCurrentNumCache,s.lastCache=Date.now())):"founded"===e?s.composeResultList=t.result:"over"===e&&(s.composeCurrentNum=s.composeResultTotal,s.stop())}},stop:function(){this.searching?this.$emit("terminate"):this.isComposeComparing&&(this.worker&&this.worker.terminate(),this.isDone=!0,this.isComposeComparing=!1)}}}}).call(this,s("0a82"))},bbae:function(t,e,s){"use strict";s("d41a")},d41a:function(t,e,s){},e73f:function(t,e,s){"use strict";var o=s("3af5"),i=s("ae69");o={components:{ComboTable:o.a},mixins:[i.a],props:{list:{type:Array},isShowUnimCols:{type:Boolean,default:!1},setting:{type:Object},isShowPropScore:{type:Boolean,default:!1},isShow2Precision:{type:Boolean},isMixHeroData:{type:Boolean},validProps:{type:Array}},methods:{saveCombo:function(t){t=t.combo,t.setting=this.setting,this.$store.commit("saveCombo",{combo:t,name:t.setting.summary})},getComboList:function(t){for(var e=1,s=[];t[e];)s.push(t[e]),e++;return s}}},i=s("2877"),s=Object(i.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:"",border:"",size:"mini"}},[s("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return e=e.row,[s("combo-table",{ref:"table",attrs:{"combo-list":t.getComboList(e),"is-show-unim-cols":t.isShowUnimCols,"is-show-prop-score":t.isShowPropScore,"is-show-collected-info":!0,"valid-props":t.validProps,"is-show2precision":t.isShow2Precision,"is-mix-hero-data":t.isMixHeroData,"max-height":0,"is-show-page":!1,setting:t.setting},scopedSlots:t._u([{key:"default",fn:function(e){return[t.checkCollectedName(e.combo,!0)?[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return t.save(e)}}},[t._v(" 已收藏 ")])]:[s("el-button",{staticStyle:{width:"68px"},attrs:{size:"mini",type:"success"},on:{click:function(s){return t.saveCombo(e)}}},[t._v(" 收藏 ")])]]}}],null,!0)})]}}])}),s("el-table-column",{attrs:{label:"面板总和",prop:"total"}})],1)}),[],!1,null,"f2eb08ba",null);e.a=s.exports}}]);